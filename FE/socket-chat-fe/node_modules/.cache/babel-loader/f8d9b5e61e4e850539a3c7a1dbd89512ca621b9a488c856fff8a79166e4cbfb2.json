{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dell\\\\Desktop\\\\clone\\\\FE\\\\socket-chat-fe\\\\src\\\\component\\\\ChatRoom.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport Moment from \"react-moment\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatRoom = () => {\n  _s();\n  const location = useLocation();\n  const msgBoxRef = useRef();\n  const [data, setData] = useState({});\n  const [msg, setMsg] = useState(\"\");\n  const [socket, setSocket] = useState();\n  const [allMessages, setMessages] = useState([]);\n  useEffect(() => {\n    const socket = io(\"http://localhost:8000/\");\n    setSocket(socket);\n    socket.on(\"connect\", () => {\n      console.log(socket.id); // x8WIv7-mJelg7on_ALbx\n\n      socket.emit(\"joinRoomm\", location.state.room);\n    });\n    socket.on(\"getLatestMessage\", newMessage => {\n      setMessages([...allMessages, newMessage]);\n    });\n  }, []);\n  useEffect(() => {\n    if (socket) {\n      socket.on(\"getLatestMessage\", newMessage => {\n        setMessages([...allMessages, newMessage]);\n        msgBoxRef.current.scrollIntoView({\n          behaviour: \"smooth\"\n        });\n        setMsg(\"\");\n      });\n    }\n  }, [socket.allMessages]);\n  useEffect(() => {\n    setData(location.data);\n  }, [location]);\n  const handleChange = e => {\n    setMsg(e.target.value);\n  };\n  const handleEnter = e => e.keyCode === 13 ? onSubmit() : \"\";\n  const onSubmit = () => {\n    if (msg) {\n      const newMessage = {\n        time: new Date(),\n        msg,\n        name: data.name\n      };\n      socket.emit(\"newMessage\", newMessage);\n    }\n\n    //setMessages(...allMessages, newMessage)\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    classname: \"py-4 m-5 w-50 shadow bg-white text-dark border rounded container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center px-3 mb-4 text-capitalize\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-warning mb-4\",\n        children: [data === null || data === void 0 ? void 0 : data.room, \" Chat Room\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-light border rounded p-3 mb-4\",\n      style: {\n        height: \"450px\",\n        overflowY: \"scroll\"\n      },\n      children: [allMessages.map(msg => {\n        return data.name === msg.name ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row-justify-content-end pl-5\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            classname: \"d-flex flex-column align-items-end m-2 shadow p-2 bg-info border rounded w-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                className: \"m-1\",\n                children: msg.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 74,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                className: \"text-muted\",\n                children: /*#__PURE__*/_jsxDEV(Moment, {\n                  fromNow: true,\n                  children: \"1976-04-19T12:59-0500\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 75,\n                  columnNumber: 59\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 75,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"m-1\",\n              children: msg.msg\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row-justify-content-start\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            classname: \"d-flex flex-column align-items m-2 shadow p-2 bg-info border rounded w-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                className: \"m-1\",\n                children: msg.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 84,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                className: \"text-muted m-1\",\n                children: /*#__PURE__*/_jsxDEV(Moment, {\n                  fromNow: true,\n                  children: \"1976-04-19T12:59-0500\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 85,\n                  columnNumber: 63\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"m-1\",\n              children: msg.msg\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 17\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: msgBoxRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group d-flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        className: \"form-control bg-light\",\n        name: \"message\",\n        value: msg,\n        onChange: handleChange,\n        onKeyDown: handleEnter,\n        placeholder: \"Type your name:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"btn btn-warning mx-2\",\n        onClick: onSubmit,\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          fill: \"currentColor\",\n          class: \"bi bi-send\",\n          viewBox: \"0 0 16 16\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatRoom, \"FXnkDOF9Sl0dvM3hbnEi0RcfCxI=\", false, function () {\n  return [useLocation];\n});\n_c = ChatRoom;\nexport default ChatRoom;\nvar _c;\n$RefreshReg$(_c, \"ChatRoom\");","map":{"version":3,"names":["useState","useEffect","useRef","useLocation","Moment","io","ChatRoom","location","msgBoxRef","data","setData","msg","setMsg","socket","setSocket","allMessages","setMessages","on","console","log","id","emit","state","room","newMessage","current","scrollIntoView","behaviour","handleChange","e","target","value","handleEnter","keyCode","onSubmit","time","Date","name","height","overflowY","map"],"sources":["C:/Users/Dell/Desktop/clone/FE/socket-chat-fe/src/component/ChatRoom.jsx"],"sourcesContent":["import { useState,useEffect, useRef } from \"react\"\r\nimport {useLocation} from \"react-router-dom\"\r\nimport Moment from \"react-moment\"\r\nimport { io } from \"socket.io-client\";\r\n\r\n\r\nconst ChatRoom=()=>{\r\n    const location=useLocation()\r\n    const msgBoxRef=useRef()\r\n\r\n    const[data,setData]=useState({})\r\n    const[msg,setMsg]=useState(\"\")\r\n    const[socket,setSocket]=useState()\r\n    const[allMessages,setMessages]=useState([])\r\n\r\n    useEffect(()=>{\r\n        const socket = io(\"http://localhost:8000/\");\r\n        setSocket(socket)\r\n        socket.on(\"connect\", () => {\r\n            console.log(socket.id); // x8WIv7-mJelg7on_ALbx\r\n\r\n            socket.emit(\"joinRoomm\",location.state.room)\r\n          })\r\n          socket.on(\"getLatestMessage\",newMessage=>{\r\n            setMessages([...allMessages,newMessage])\r\n          })\r\n    },[])\r\n\r\n    useEffect(()=>{\r\n        if(socket){\r\n            socket.on(\"getLatestMessage\",newMessage=>{\r\n                setMessages([...allMessages,newMessage])\r\n                msgBoxRef.current.scrollIntoView({behaviour:\"smooth\"})\r\n                setMsg(\"\")\r\n            })\r\n        }\r\n    },[socket.allMessages])\r\n\r\n    useEffect(()=>\r\n    {\r\n        setData(location.data)\r\n    },[location])\r\n\r\n    const handleChange=e=>{\r\n        setMsg(e.target.value)\r\n\r\n    }\r\n\r\n    const handleEnter=e=>e.keyCode===13 ? onSubmit():\"\"\r\n\r\n    const onSubmit=()=>{\r\n        if(msg){\r\n            const newMessage={time: new Date(),msg, name:data.name}\r\n            socket.emit(\"newMessage\",newMessage)\r\n        }\r\n        \r\n        //setMessages(...allMessages, newMessage)\r\n    }\r\n\r\n\r\n    return(\r\n        <div classname=\"py-4 m-5 w-50 shadow bg-white text-dark border rounded container\">\r\n            <div className=\"text-center px-3 mb-4 text-capitalize\">\r\n                <h1 className=\"text-warning mb-4\">{data?.room} Chat Room</h1>\r\n            </div>\r\n            <div className=\"bg-light border rounded p-3 mb-4\" style={{height:\"450px\",overflowY:\"scroll\"}}>\r\n                {\r\n                    allMessages.map(msg=>{\r\n                        return data.name === msg.name\r\n                        ?\r\n                    <div className=\"row-justify-content-end pl-5\">\r\n                    <div classname=\"d-flex flex-column align-items-end m-2 shadow p-2 bg-info border rounded w-auto\">\r\n                        <div>\r\n                            <strong className=\"m-1\">{msg.name}</strong>\r\n                            <small className=\"text-muted\"><Moment fromNow>1976-04-19T12:59-0500</Moment></small>\r\n                        </div>\r\n                        <h4 className=\"m-1\">{msg.msg}</h4>\r\n                    </div>\r\n                </div>\r\n                :\r\n                <div className=\"row-justify-content-start\">\r\n                    <div classname=\"d-flex flex-column align-items m-2 shadow p-2 bg-info border rounded w-auto\">\r\n                        <div>\r\n                            <strong className=\"m-1\">{msg.name}</strong>\r\n                            <small className=\"text-muted m-1\"><Moment fromNow>1976-04-19T12:59-0500</Moment></small>\r\n                        </div>\r\n                        <h4 className=\"m-1\">{msg.msg}</h4>\r\n                    </div>\r\n                </div>\r\n\r\n                    })\r\n                }       \r\n                <div ref={msgBoxRef}></div>\r\n        </div>\r\n        <div className=\"form-group d-flex\">\r\n            <input type=\"text\" className=\"form-control bg-light\" name=\"message\" value={msg} onChange={handleChange} onKeyDown={handleEnter} placeholder=\"Type your name:\"></input>\r\n            <button type=\"button\" className=\"btn btn-warning mx-2\" onClick={onSubmit}>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-send\" viewBox=\"0 0 16 16\">\r\n            <path d=\"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z\"/>\r\n            </svg>\r\n            </button>\r\n            </div>\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\n\r\nexport default ChatRoom"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}